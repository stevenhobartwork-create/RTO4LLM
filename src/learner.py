#!/usr/bin/env python3
"""
RTO4LLM - Dictionary Learning Module
====================================
Manages three-tier dictionary system for text compression.

License: GPL-3.0-or-later
Repository: https://github.com/StevenGITHUBwork/RTO4LLM

Code contributions and optimizations by:
  - GitHub Copilot (Claude Opus 4.5)
  - Dictionary built from 500MB real-world corpus scan
"""
import os
import re
import json
import collections
from pathlib import Path

# Configuration
MODEL_FILE = Path(__file__).parent.parent / "state" / "frequency_model.json"

# Static Dictionaries (Fallback / Bootstrapping)
STATIC_GLOBAL = [
    "function", "return", "import", "export", "const", "class", "while", "false",
    "undefined", "string", "number", "object", "package", "public", "private",
    "include", "define", "struct", "typedef", "sizeof", "static", "switch",
    "default", "break", "continue", "namespace", "template", "typename",
    "virtual", "override", "operator", "friend", "inline", "explicit",
    "module", "require", "exports", "process", "global", "window", "document",
    "console", "length", "forEach", "map", "filter", "reduce", "push", "pop",
    "shift", "unshift", "splice", "slice", "indexOf", "includes", "join",
    "split", "replace", "match", "search", "test", "exec", "toString",
    "valueOf", "JSON", "stringify", "parse", "Promise", "async", "await",
    "try", "catch", "finally", "throw", "Error", "TypeError", "RangeError",
    "SyntaxError", "ReferenceError", "Math", "Date", "RegExp", "Array",
    "Object", "String", "Number", "Boolean", "Function", "Symbol", "BigInt",
    "Map", "Set", "WeakMap", "WeakSet", "Int8Array", "Uint8Array",
    "Uint8ClampedArray", "Int16Array", "Uint16Array", "Int32Array",
    "Uint32Array", "Float32Array", "Float64Array", "ArrayBuffer",
    "SharedArrayBuffer", "DataView", "Atomics", "WebAssembly", "null", "true"
]

TYPE_SPECIFIC = {
    "py": ["self", "def", "None", "True", "False", "print", "len", "str", "int", "dict", "list", "set", "tuple", "range", "enumerate", "zip", "isinstance", "issubclass", "super", "yield", "with", "as", "lambda", "pass", "raise", "except", "finally", "try", "import", "from", "class", "return", "if", "elif", "else", "for", "while", "break", "continue", "and", "or", "not", "in", "is", "del", "global", "nonlocal", "assert", "async", "await"],
    "js": ["function", "return", "var", "let", "const", "if", "else", "for", "while", "do", "switch", "case", "default", "break", "continue", "try", "catch", "finally", "throw", "new", "delete", "typeof", "instanceof", "void", "this", "arguments", "super", "class", "extends", "implements", "interface", "package", "private", "protected", "public", "static", "yield", "await", "async", "import", "export", "null", "true", "false", "undefined", "NaN", "Infinity"],
    "c": ["int", "char", "float", "double", "void", "long", "short", "unsigned", "signed", "const", "static", "volatile", "extern", "register", "auto", "struct", "union", "enum", "typedef", "sizeof", "return", "if", "else", "for", "while", "do", "switch", "case", "default", "break", "continue", "goto", "include", "define", "ifdef", "ifndef", "endif", "pragma"],
    "h": ["int", "char", "float", "double", "void", "long", "short", "unsigned", "signed", "const", "static", "volatile", "extern", "register", "auto", "struct", "union", "enum", "typedef", "sizeof", "return", "if", "else", "for", "while", "do", "switch", "case", "default", "break", "continue", "goto", "include", "define", "ifdef", "ifndef", "endif", "pragma"],
    "cpp": ["int", "char", "float", "double", "void", "long", "short", "unsigned", "signed", "const", "static", "volatile", "extern", "register", "auto", "struct", "union", "enum", "typedef", "sizeof", "return", "if", "else", "for", "while", "do", "switch", "case", "default", "break", "continue", "goto", "include", "define", "ifdef", "ifndef", "endif", "pragma", "class", "public", "private", "protected", "virtual", "friend", "inline", "template", "typename", "namespace", "using", "new", "delete", "this", "operator", "try", "catch", "throw", "explicit", "override", "final", "nullptr", "constexpr", "noexcept", "static_assert", "decltype", "auto", "bool", "true", "false"],
    "ts": ["function", "return", "var", "let", "const", "if", "else", "for", "while", "do", "switch", "case", "default", "break", "continue", "try", "catch", "finally", "throw", "new", "delete", "typeof", "instanceof", "void", "this", "arguments", "super", "class", "extends", "implements", "interface", "package", "private", "protected", "public", "static", "yield", "await", "async", "import", "export", "null", "true", "false", "undefined", "NaN", "Infinity", "any", "number", "string", "boolean", "void", "never", "unknown", "object", "symbol", "bigint", "type", "interface", "enum", "namespace", "module", "declare", "abstract", "as", "is", "keyof", "readonly", "unique"],
    "rs": ["fn", "let", "mut", "const", "static", "if", "else", "for", "while", "loop", "match", "break", "continue", "return", "struct", "enum", "impl", "trait", "pub", "mod", "use", "crate", "self", "super", "as", "where", "type", "unsafe", "extern", "ref", "move", "dyn", "async", "await", "Some", "None", "Ok", "Err", "Result", "Option", "Vec", "String", "Box", "Rc", "Arc", "Cell", "RefCell", "Mutex", "RwLock", "HashMap", "HashSet", "BTreeMap", "BTreeSet", "println", "print", "format", "panic", "assert", "debug_assert", "cfg", "derive", "Clone", "Copy", "Debug", "Default", "PartialEq", "Eq", "PartialOrd", "Ord", "Hash", "Send", "Sync", "Sized", "Drop", "Fn", "FnMut", "FnOnce", "Iterator", "IntoIterator", "From", "Into", "TryFrom", "TryInto", "AsRef", "AsMut", "Deref", "DerefMut", "Display", "Error", "usize", "isize", "u8", "u16", "u32", "u64", "u128", "i8", "i16", "i32", "i64", "i128", "f32", "f64", "bool", "char", "str", "lifetime", "macro_rules", "macro_export", "allow", "deny", "warn", "must_use", "inline", "test", "bench", "feature", "serde", "tokio", "anyhow", "thiserror"],
    "sh": ["if", "then", "else", "elif", "fi", "for", "in", "do", "done", "while", "until", "case", "esac", "function", "return", "local", "export", "readonly", "declare", "typeset", "unset", "shift", "exit", "break", "continue", "source", "eval", "exec", "trap", "set", "shopt", "getopts", "read", "echo", "printf", "test", "true", "false", "cd", "pwd", "pushd", "popd", "dirs", "ls", "cp", "mv", "rm", "mkdir", "rmdir", "touch", "cat", "head", "tail", "grep", "sed", "awk", "cut", "sort", "uniq", "wc", "tr", "xargs", "find", "basename", "dirname", "realpath", "readlink", "which", "whereis", "type", "command", "alias", "unalias", "bg", "fg", "jobs", "kill", "wait", "nohup", "disown", "ps", "top", "htop", "df", "du", "free", "uname", "hostname", "whoami", "id", "groups", "sudo", "su", "chown", "chmod", "chgrp", "umask", "tar", "gzip", "gunzip", "zip", "unzip", "curl", "wget", "ssh", "scp", "rsync", "git", "make", "npm", "pip", "PATH", "HOME", "USER", "SHELL", "PWD", "OLDPWD", "IFS", "BASH", "BASH_VERSION", "RANDOM", "LINENO", "FUNCNAME", "PIPESTATUS", "OPTARG", "OPTIND", "REPLY", "SECONDS", "TERM", "EDITOR", "VISUAL", "LANG", "LC_ALL"],
    "bash": ["if", "then", "else", "elif", "fi", "for", "in", "do", "done", "while", "until", "case", "esac", "function", "return", "local", "export", "readonly", "declare", "typeset", "unset", "shift", "exit", "break", "continue", "source", "eval", "exec", "trap", "set", "shopt", "getopts", "read", "echo", "printf", "test", "true", "false", "cd", "pwd", "pushd", "popd", "dirs", "ls", "cp", "mv", "rm", "mkdir", "rmdir", "touch", "cat", "head", "tail", "grep", "sed", "awk", "cut", "sort", "uniq", "wc", "tr", "xargs", "find", "basename", "dirname", "realpath", "readlink", "which", "whereis", "type", "command", "alias", "unalias", "bg", "fg", "jobs", "kill", "wait", "nohup", "disown", "ps", "top", "htop", "df", "du", "free", "uname", "hostname", "whoami", "id", "groups", "sudo", "su", "chown", "chmod", "chgrp", "umask", "tar", "gzip", "gunzip", "zip", "unzip", "curl", "wget", "ssh", "scp", "rsync", "git", "make", "npm", "pip", "PATH", "HOME", "USER", "SHELL", "PWD", "OLDPWD", "IFS", "BASH", "BASH_VERSION", "RANDOM", "LINENO", "FUNCNAME", "PIPESTATUS", "OPTARG", "OPTIND", "REPLY", "SECONDS", "TERM", "EDITOR", "VISUAL", "LANG", "LC_ALL"],
    "md": ["the", "and", "to", "of", "a", "in", "is", "that", "for", "on", "with", "as", "are", "it", "be", "this", "or", "by", "not", "from", "at", "an", "but", "can", "if", "which", "you", "all", "have", "has", "was", "were", "so", "my", "your", "we", "they", "he", "she", "it", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "ten", "first", "second", "third", "last", "next", "previous", "new", "old", "good", "bad", "high", "low", "big", "small", "long", "short", "large", "little", "great", "important", "use", "used", "using", "user", "file", "files", "data", "code", "text", "image", "video", "audio", "link", "url", "http", "https", "www", "com", "org", "net", "edu", "gov", "mil", "io", "co", "uk", "ca", "de", "fr", "jp", "cn", "ru", "br", "in", "au", "us", "info", "biz", "name", "pro", "mobi", "tel", "asia", "xxx", "jobs", "museum", "travel", "aero", "cat", "coop", "int", "arpa", "root", "to", "cc", "cd", "ls", "pwd", "cd", "mkdir", "rm", "cp", "mv", "touch", "cat", "less", "more", "head", "tail", "grep", "find", "locate", "whereis", "which", "man", "info", "help", "exit", "logout", "shutdown", "reboot", "halt", "poweroff", "clear", "history", "alias", "unalias", "echo", "printf", "read", "test", "true", "false", "yes", "no", "seq", "shuf", "sort", "uniq", "wc", "tr", "cut", "paste", "join", "comm", "diff", "patch", "sed", "awk", "grep", "egrep", "fgrep", "tar", "gzip", "gunzip", "bzip2", "bunzip2", "xz", "unxz", "zip", "unzip", "7z", "rar", "unrar", "ssh", "scp", "sftp", "ftp", "telnet", "nc", "netcat", "ping", "traceroute", "nslookup", "dig", "host", "whois", "curl", "wget", "lynx", "links", "elinks", "w3m", "git", "svn", "hg", "bzr", "cvs", "rcs", "make", "cmake", "ant", "maven", "gradle", "npm", "yarn", "pip", "gem", "bundle", "cargo", "go", "rustc", "gcc", "g++", "clang", "clang++", "java", "javac", "python", "perl", "ruby", "php", "lua", "bash", "sh", "zsh", "csh", "tcsh", "ksh", "fish", "vim", "vi", "emacs", "nano", "pico", "ed", "sed", "awk", "grep", "find", "xargs", "sudo", "su", "chown", "chmod", "chgrp", "umask", "useradd", "userdel", "usermod", "groupadd", "groupdel", "groupmod", "passwd", "shadow", "gshadow", "fstab", "mtab", "inittab", "crontab", "hosts", "resolv.conf", "nsswitch.conf", "profile", "bashrc", "bash_profile", "bash_logout", "zshrc", "zprofile", "zlogout", "vimrc", "emacs", "nanorc", "gitconfig", "gitignore", "dockerfile", "makefile", "package.json", "requirements.txt", "setup.py", "pom.xml", "build.gradle", "Gemfile", "Rakefile", "Procfile", "Vagrantfile", "Jenkinsfile", "Travis.yml", "circle.yml", "gitlab-ci.yml", "appveyor.yml", "azure-pipelines.yml", "bitbucket-pipelines.yml", "cloudbuild.yaml", "codecov.yml", "coveralls.yml", "sonar-project.properties", "tox.ini", "pytest.ini", "setup.cfg", "MANIFEST.in", "LICENSE", "README", "CONTRIBUTING", "CHANGELOG", "CODE_OF_CONDUCT", "SECURITY", "AUTHORS", "OWNERS", "GOVERNANCE", "SUPPORT", "funding", "citation", "codemeta", "cff", "doi", "zenodo", "orcid", "ror", "grid", "isni", "ringgold", "viaf", "wikidata", "wikipedia", "google", "scholar", "researchgate", "academia", "mendeley", "zotero", "endnote", "bibtex", "ris", "csv", "json", "xml", "yaml", "toml", "ini", "conf", "cfg", "properties", "env", "sh", "bat", "ps1", "cmd", "exe", "dll", "so", "dylib", "a", "o", "obj", "class", "jar", "war", "ear", "zip", "tar", "gz", "bz2", "xz", "7z", "rar", "iso", "img", "vmdk", "vdi", "qcow2", "raw", "bin", "hex", "elf", "mach-o", "pe", "coff", "a.out", "core", "log", "txt", "md", "rst", "adoc", "tex", "pdf", "doc", "docx", "xls", "xlsx", "ppt", "pptx", "odt", "ods", "odp", "rtf", "html", "htm", "css", "js", "ts", "jsx", "tsx", "vue", "svelte", "php", "asp", "aspx", "jsp", "cfm", "cgi", "pl", "py", "rb", "java", "c", "cpp", "h", "hpp", "cs", "go", "rs", "swift", "kt", "kts", "scala", "clj", "cljs", "cljc", "edn", "hs", "lhs", "ml", "mli", "fs", "fsi", "fsx", "fsscript", "erl", "hrl", "ex", "exs", "lfe", "elm", "purescript", "purs", "idris", "agda", "coq", "lean", "fstar", "k", "q", "apl", "j", "r", "rmd", "rnw", "s", "splus", "sas", "spss", "stata", "matlab", "octave", "julia", "jl", "fortran", "f", "f77", "f90", "f95", "f03", "f08", "cobol", "cbl", "cob", "cpy", "pascal", "pas", "pp", "d", "di", "ada", "adb", "ads", "vhdl", "vhd", "verilog", "v", "sv", "svh", "systemverilog", "assembly", "asm", "s", "nasm", "masm", "tasm", "gas", "llvm", "ll", "bc", "wasm", "wat", "wast", "lisp", "lsp", "l", "cl", "fasl", "scheme", "scm", "ss", "racket", "rkt", "clojure", "clj", "cljs", "cljc", "edn", "smalltalk", "st", "self", "io", "newspeak", "newsqueak", "strongtalk", "slate", "factor", "forth", "fth", "4th", "postscript", "ps", "eps", "pdf", "ghostscript", "gs", "tcl", "tk", "wish", "expect", "lua", "wren", "squirrel", "game", "engine", "unity", "unreal", "godot", "cryengine", "lumberyard", "source", "id", "tech", "frostbite", "red", "engine", "iw", "engine", "anvil", "snowdrop", "dunia", "disrupt", "chrome", "engine", "rage", "creation", "engine", "gamebryo", "renderware", "havok", "physx", "bullet", "ode", "box2d", "chipmunk", "newton", "vortex", "karma", "meqon", "tokamak", "true", "axis", "agx", "dynamics", "phymod", "simbody", "dart", "mujoco", "gazebo", "v-rep", "webots", "morse", "usarsim", "stdr", "stage", "player", "ros", "ros2", "robot", "operating", "system", "middleware", "framework", "library", "tool", "utility", "application", "program", "software", "hardware", "firmware", "driver", "kernel", "bootloader", "bios", "uefi", "firmware", "microcode", "virtual", "machine", "hypervisor", "container", "docker", "kubernetes", "podman", "lxc", "lxd", "rkt", "jail", "zone", "chroot", "sandbox", "vmware", "virtualbox", "qemu", "kvm", "xen", "hyper-v", "esxi", "vsphere", "vcenter", "cloud", "aws", "azure", "gcp", "ibm", "oracle", "alibaba", "tencent", "huawei", "digitalocean", "linode", "vultr", "heroku", "netlify", "vercel", "firebase", "fly", "render", "railway", "platform", "service", "infrastructure", "function", "serverless", "lambda", "functions", "app", "engine", "beanstalk", "ec2", "s3", "rds", "dynamodb", "cosmosdb", "sql", "nosql", "database", "mysql", "postgresql", "sqlite", "mariadb", "oracle", "sql", "server", "db2", "informix", "sybase", "firebird", "interbase", "hsqldb", "h2", "derby", "access", "foxpro", "paradox", "dbase", "clipper", "filemaker", "4d", "omnis", "progress", "ingress", "unify", "gupta", "clarion", "magic", "powerbuilder", "delphi", "lazarus", "visual", "basic", "vb", "vba", "vbscript", "vb6", "vb.net", "c#", "f#", "j#", "jscript", "typescript", "coffeescript", "livescript", "dart", "haxe", "actionscript", "flex", "flash", "silverlight", "javafx", "swing", "awt", "swt", "qt", "gtk", "wxwidgets", "fltk", "fox", "juce", "sdl", "sfml", "allegro", "raylib", "love", "pygame", "pyglet", "panda3d", "godot", "defold", "cocos2d", "phaser", "pixi", "three", "babylon", "aframe", "playcanvas", "construct", "gamemaker", "rpg", "maker", "stencyl", "scratch", "snap", "blockly", "alice", "greenfoot", "bluej", "processing", "p5", "openframeworks", "cinder", "max", "msp", "pd", "supercollider", "chuck", "csound", "faust", "sonic", "pi", "tidal", "cycles", "foxdot", "orca", "hydra", "vis", "glsl", "hlsl", "cg", "metal", "vulkan", "opengl", "directx", "webgl", "webgpu", "cuda", "opencl", "hip", "rocm", "oneapi", "sycl", "kokkos", "raja", "tbb", "openmp", "mpi", "gasnet", "charm++", "legion", "hpx", "chapel", "x10", "upc", "caf", "coarray", "fortran", "titanium", "phonegap", "cordova", "ionic", "react", "native", "flutter", "xamarin", "maui", "uno", "avalonia", "qt", "qml", "kirigami", "plasma", "gnome", "kde", "xfce", "lxde", "lxqt", "mate", "cinnamon", "budgie", "pantheon", "enlightenment", "i3", "sway", "bspwm", "xmonad", "awesome", "dwm", "ratpoison", "stumpwm", "herbstluftwm", "spectrwm", "wmderland", "leftwm", "river", "cage", "velox", "wayfire", "labwc", "hikari", "grefsen", "wio", "newm", "dwl", "tinywl", "wayland", "x11", "xorg", "mir", "surfaceflinger", "quartz", "gdi", "gdi+", "direct2d", "directwrite", "skia", "cairo", "pango", "harfbuzz", "freetype", "fontconfig", "pixman", "libpng", "libjpeg", "libtiff", "libwebp", "libavif", "libheif", "libjxl", "librsvg", "imagemagick", "graphicsmagick", "ffmpeg", "gstreamer", "vlc", "mpv", "mplayer", "xine", "totem", "rhythmbox", "banshee", "amarok", "clementine", "audacious", "qmmp", "deadbeef", "cmus", "moc", "mpd", "ncmpcpp", "beets", "picard", "musicbrainz", "discogs", "lastfm", "spotify", "pandora", "deezer", "tidal", "applemusic", "youtube", "music", "soundcloud", "bandcamp", "mixcloud", "hearthis", "audiomack", "jamendo", "magnatune", "ccmixter", "freesound", "archive", "org", "librivox", "gutenberg", "wikipedia", "wiktionary", "wikibooks", "wikinews", "wikiquote", "wikisource", "wikiversity", "wikivoyage", "wikidata", "wikimedia", "commons", "meta", "wiki", "mediawiki", "dokuwiki", "moinmoin", "twiki", "foswiki", "xwiki", "confluence", "sharepoint", "notion", "obsidian", "roam", "logseq", "remnote", "evernote", "onenote", "google", "keep", "apple", "notes", "simplenote", "standard", "notes", "joplin", "turtl", "laverna", "boostnote", "qownnotes", "zim", "tiddlywiki", "vimwiki", "org", "mode", "markdown", "asciidoc", "restructuredtext", "textile", "wikitext", "creole", "pod", "rdoc", "javadoc", "doxygen", "sphinx", "mkdocs", "jekyll", "hugo", "gatsby", "next", "nuxt", "vuepress", "gridsome", "eleventy", "pelican", "nikola", "hexo", "middleman", "metalsmith", "assemble", "docpad", "harp", "cactus", "lektor", "publii", "ghost", "wordpress", "drupal", "joomla", "typo3", "contao", "concrete5", "modx", "processwire", "grav", "kirby", "statamic", "craft", "expressionengine", "perch", "couch", "bolt", "monstra", "pivotx", "wolf", "cms", "symphony", "textpattern", "b2evolution", "serendipity", "dotclear", "habari", "known", "pligg", "elgg", "dolphin", "oxwall", "buddypress", "humhub", "friendica", "diaspora", "mastodon", "pleroma", "misskey", "pixelfed", "peertube", "funkwhale", "mobilizon", "writefreely", "plume", "hubzilla", "zap", "streams", "gnusocial", "statusnet", "identica", "pump", "io", "activitypub", "ostatus", "zot", "dfrn", "salmon", "webfinger", "webmention", "pubsubhubbub", "rss", "atom", "json", "feed", "opml", "sitemap", "robots", "txt", "humans", "txt", "ads", "txt", "security", "txt", "well", "known", "favicon", "ico", "apple", "touch", "icon", "png", "og", "image", "twitter", "card", "schema", "org", "microformats", "hcard", "hcalendar", "hreview", "hrecipe", "hproduct", "hentry", "geo", "tag", "rel", "nofollow", "noreferrer", "noopener", "me", "license", "alternate", "canonical", "shortlink", "pingback", "manifest", "service", "worker", "pwa", "amp", "instant", "article", "facebook", "instant", "articles", "apple", "news", "google", "news", "flipboard", "smartnews", "upday", "news", "republic", "feedly", "inoreader", "newsblur", "the", "old", "reader", "netvibes", "protopage", "start", "me", "symbaloo", "ighome", "my", "yahoo", "msn", "aol", "google", "bing", "yahoo", "duckduckgo", "startpage", "qwant", "ecosia", "searx", "yandex", "baidu", "sogou", "naver", "daum", "ask", "aol", "excite", "lycos", "altavista", "webcrawler", "dogpile", "metacrawler", "info", "com", "hotbot", "gigablast", "mojeek", "swisscows", "gibiru", "peekier", "searchencrypt", "disconnect", "private", "search", "wolframalpha", "archive", "wayback", "machine", "internet", "archive", "library", "congress", "british", "library", "bibliotheque", "nationale", "france", "deutsche", "nationalbibliothek", "dietrich", "bonhoeffer", "library", "new", "york", "public", "library", "boston", "public", "library", "chicago", "public", "library", "los", "angeles", "public", "library", "san", "francisco", "public", "library", "seattle", "public", "library", "toronto", "public", "library", "vancouver", "public", "library", "montreal", "public", "library", "london", "public", "library", "manchester", "public", "library", "birmingham", "public", "library", "liverpool", "public", "library", "glasgow", "public", "library", "edinburgh", "public", "library", "dublin", "public", "library", "belfast", "public", "library", "cardiff", "public", "library", "national", "library", "scotland", "national", "library", "wales", "national", "library", "ireland", "trinity", "college", "library", "bodleian", "library", "cambridge", "university", "library", "harvard", "library", "yale", "library", "princeton", "library", "columbia", "library", "cornell", "library", "stanford", "library", "berkeley", "library", "mit", "library", "caltech", "library", "cmu", "library", "uiuc", "library", "umich", "library", "utexas", "library", "uw", "library", "unc", "library", "uva", "library", "ucla", "library", "ucsd", "library", "ucsf", "library", "ucdavis", "library", "uci", "library", "ucsb", "library", "ucsc", "library", "ucr", "library", "ucm", "library", "csu", "library", "suny", "library", "cuny", "library", "nyu", "library", "usc", "library", "bu", "library", "bc", "library", "northeastern", "library", "tufts", "library", "brandeis", "library", "brown", "library", "dartmouth", "library", "upenn", "library", "pitt", "library", "psu", "library", "temple", "library", "drexel", "library", "jhu", "library", "umd", "library", "georgetown", "library", "gwu", "library", "american", "library", "howard", "library", "catholic", "library", "gmu", "library", "vcu", "library", "vt", "library", "uva", "library", "wm", "library", "odu", "library", "jmu", "library", "unc", "library", "duke", "library", "ncsu", "library", "wake", "forest", "library", "davidson", "library", "sc", "library", "clemson", "library", "uga", "library", "gatech", "library", "emory", "library", "fsu", "library", "uf", "library", "miami", "library", "usf", "library", "ucf", "library", "fiu", "library", "fau", "library", "unf", "library", "uwf", "library", "fgcu", "library", "alabama", "library", "auburn", "library", "uab", "library", "uah", "library", "usa", "library", "mississippi", "library", "msu", "library", "usm", "library", "lsu", "library", "tulane", "library", "uno", "library", "ulm", "library", "latech", "library", "arkansas", "library", "asu", "library", "ualr", "library", "uca", "library", "tennessee", "library", "vanderbilt", "library", "memphis", "library", "mtsu", "library", "etsu", "library", "utc", "library", "kentucky", "library", "louisville", "library", "wku", "library", "eku", "library", "nku", "library", "morehead", "library", "murray", "library", "ohio", "library", "osu", "library", "cincinnati", "library", "miami", "library", "ou", "library", "bgsu", "library", "utoledo", "library", "akron", "library", "kent", "library", "ysu", "library", "wright", "library", "dayton", "library", "xavier", "library", "case", "library", "cleveland", "library", "michigan", "library", "msu", "library", "wayne", "library", "wmich", "library", "emich", "library", "cmich", "library", "nmich", "library", "mtu", "library", "ferris", "library", "gvsu", "library", "svsu", "library", "oakland", "library", "indiana", "library", "purdue", "library", "notre", "dame", "library", "ball", "state", "library", "isu", "library", "iupui", "library", "illinois", "library", "uic", "library", "uis", "library", "niu", "library", "siu", "library", "isu", "library", "eiu", "library", "wiu", "library", "neiu", "library", "csu", "library", "gsu", "library", "loyola", "library", "depaul", "library", "northwestern", "library", "uchicago", "library", "iit", "library", "wisconsin", "library", "milwaukee", "library", "eau", "claire", "library", "green", "bay", "library", "lacrosse", "library", "oshkosh", "library", "parkside", "library", "platteville", "library", "river", "falls", "library", "stevens", "point", "library", "stout", "library", "superior", "library", "whitewater", "library", "marquette", "library", "minnesota", "library", "duluth", "library", "mankato", "library", "moorhead", "library", "st", "cloud", "library", "winona", "library", "bemidji", "library", "southwest", "library", "iowa", "library", "isu", "library", "uni", "library", "drake", "library", "missouri", "library", "umkc", "library", "umsl", "library", "mst", "library", "semo", "library", "missouristate", "library", "slu", "library", "washu", "library", "kansas", "library", "ksu", "library", "wichita", "library", "emporia", "library", "pittsburg", "library", "fort", "hays", "library", "washburn", "library", "nebraska", "library", "uno", "library", "unk", "library", "creighton", "library", "sd", "library", "sdsu", "library", "usd", "library", "nd", "library", "ndsu", "library", "und", "library", "montana", "library", "msu", "library", "um", "library", "wyoming", "library", "colorado", "library", "csu", "library", "unc", "library", "cu", "denver", "library", "uccs", "library", "mines", "library", "du", "library", "regis", "library", "new", "mexico", "library", "nmsu", "library", "nmt", "library", "enmu", "library", "wnmu", "library", "arizona", "library", "asu", "library", "nau", "library", "utah", "library", "usu", "library", "byu", "library", "weber", "library", "suu", "library", "uvu", "library", "nevada", "library", "unlv", "library", "unr", "library", "idaho", "library", "isu", "library", "bsu", "library", "washington", "library", "wsu", "library", "wwu", "library", "cwu", "library", "ewu", "library", "evergreen", "library", "seattleu", "library", "spu", "library", "plu", "library", "ups", "library", "whitman", "library", "gonzaga", "library", "oregon", "library", "osu", "library", "pdx", "library", "uoregon", "library", "wou", "library", "sou", "library", "eou", "library", "oit", "library", "willamette", "library", "reed", "library", "lclark", "library", "up", "library", "pacific", "library", "george", "fox", "library", "linfield", "library", "california", "library", "berkeley", "library", "davis", "library", "irvine", "library", "ucla", "library", "merced", "library", "riverside", "library", "sandiego", "library", "sf", "library", "santabarbara", "library", "santacruz", "library", "stanford", "library", "usc", "library", "caltech", "library", "csu", "library", "poly", "library", "pomona", "library", "slo", "library", "sjsu", "library", "sfsu", "library", "csueb", "library", "csumb", "library", "fresno", "library", "bakersfield", "library", "stanislaus", "library", "sacramento", "library", "chico", "library", "humboldt", "library", "sonoma", "library", "csun", "library", "csula", "library", "csudh", "library", "csulb", "library", "csuci", "library", "csusb", "library", "csusm", "library", "sdsu", "library", "hawaii", "library", "uh", "library", "hpu", "library", "byuh", "library", "alaska", "library", "uaa", "library", "uaf", "library", "uas", "library"]
}

def train_model(source_dirs, sample_size=100, min_len=4):
    """
    Scans directories, counts word frequencies, and builds a global dictionary.
    This is a simple 'Bag of Words' ML model for compression.
    """
    print(f"Training model from {source_dirs}...")
    counter = collections.Counter()
    
    files_scanned = 0
    for directory in source_dirs:
        directory = Path(directory)
        if not directory.exists():
            continue
            
        for root, _, files in os.walk(directory):
            for file in files:
                if files_scanned >= sample_size:
                    break
                
                # Simple heuristic to avoid binary files
                if file.endswith(('.py', '.js', '.ts', '.md', '.txt', '.c', '.h', '.sh', '.json')):
                    try:
                        with open(Path(root) / file, 'r', encoding='utf-8', errors='ignore') as f:
                            text = f.read()
                            # Extract words
                            words = re.findall(r'\b[a-zA-Z_]{' + str(min_len) + r',}\b', text)
                            counter.update(words)
                            files_scanned += 1
                    except Exception:
                        pass
            if files_scanned >= sample_size:
                break
    
    # Select top 200 words
    top_words = [word for word, count in counter.most_common(200)]
    
    # Save model
    os.makedirs(MODEL_FILE.parent, exist_ok=True)
    with open(MODEL_FILE, 'w') as f:
        json.dump({"top_words": top_words, "trained_at": str(os.path.getmtime(directory) if directory.exists() else 0)}, f)
    
    print(f"Model trained on {files_scanned} files. Saved to {MODEL_FILE}")
    return top_words

def load_model():
    if MODEL_FILE.exists():
        with open(MODEL_FILE, 'r') as f:
            data = json.load(f)
            return data.get("top_words", [])
    return []

def get_static_global():
    return STATIC_GLOBAL

def get_type_specific(ext):
    # Remove dot if present
    if ext.startswith('.'):
        ext = ext[1:]
    return TYPE_SPECIFIC.get(ext, [])

if __name__ == "__main__":
    # Standalone training
    import sys
    dirs = sys.argv[1:] if len(sys.argv) > 1 else ["~/Projects"]
    train_model(dirs)

